{% extends "layout.html" %}

{% block content %}
<h1>📑 Historial de Procesos</h1>

<!-- =============================
     Filtro por fecha de consulta
============================== -->
<section class="filtros">
    <form onsubmit="irAlHistorial(); return false;" style="margin-bottom: 15px;">
        <label for="fecha_consulta">Filtrar por fecha:</label>
        <input type="date" id="fecha_consulta" name="fecha_consulta" value="{{ fecha or '' }}">
        <button type="submit" class="btn azul">🔍 Consultar</button>
        <a href="{{ url_for('historial') }}" class="btn gris">📋 Ver todo</a>
    </form>
</section>

<!-- =============================
     Tabla del historial
============================== -->
<section>
    <table>
        <thead>
            <tr>
                <th>Fecha</th>
                <th>Acción</th>
                <th>Usuario</th>
                <th>Detalles</th>
            </tr>
        </thead>
        <tbody>
            {% for evento in historial %}
            <tr>
                <td>{{ evento.fecha }}</td>
                <td>{{ evento.accion }}</td>
                <td>{{ evento.usuario }}</td>
                <td>{{ evento.detalles }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4">⚠️ No hay registros en el historial.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>

<!-- =============================
     Botón volver
============================== -->
<section style="margin-top: 20px; text-align:center;">
    <a href="{{ url_for('index') }}" class="btn verde">🏠 Volver al inicio</a>
</section>
{% endblock %}
